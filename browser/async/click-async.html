<script>
// 在用户点击和 异步执行均完成后执行某个函数
function pro() {
  return new Promise((res, rej) => {
    setTimeout(() => {
      console.log('5000ms timeout')
      res(true)
    }, 5000);
  })
}

function done() {
  if (promiseFinish && clicked) {
    console.log('success')
  }
}

var promiseFinish = false;
var clicked = false;

pro().then((data) => {
  promiseFinish = true;
  done();
});

document.addEventListener('click', () => {
  console.log('clicked')
  clicked = true;
  done();
});
</script>